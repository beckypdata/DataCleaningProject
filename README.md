##README

This README is associated with an assignment to complete data cleaning for data originally generated in a Center for Machine Learning and Intelligent Systems study.

###Directory contents

+ CodeBook.md: description of the original study data 
+ CodeBook-tidy.md: description of the tidy data set
+ run_analysis.R: R script used to generate tidy dataset; should be run at root of the directory structure created by extracting the original study datasets
+ compareTidyDatasets.R: R script that can be used by Coursera user to validate the tidy dataset stored on Coursera aligns to tidy dataset generated by run_analysis.R

---



##Study Design

---

###The Original Study

This data cleaning effort was based on a study conducted by the Center for 
Machine Learning and Intelligent Systems.  Please refer to http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones for additional information on the study, and specifically on how study data was gathered.  The study involved 30 participants who each performed 6 activities while wearing a Samsung Galaxy S II on their waist.  The embedded accelerometer and gyroscope within the phone were used to capture linear acceleration (accelerometer) and angular velocity (gyroscope) 3-axial measurements at a constant rate of 50Hz.  These signals were decomposed to derive body acceleration and gravity components at each observation point.  

Finally, summary vectors were derived from the body acceleration and gravity components vectors at same observation points using both time domain and frequency domain.  The result was a set of 561 vectors for each of the 30 participants, performing each of the 6 activities, at all sampling points.  This derived dataset was randomly divided into two datasets with 70% of the participant data stored in the "training" data and 30% in the "test" data.

Specific summary vectors from the original study are detailed below in the Code Book section.  

###Accessing the Original Data

For purposes of this assignment, it is assumed that the original study data has been previously downloaded.  If this has not been done, please follow these steps
  
  * download https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip
  
  * extract all files to a local directory

All subsequent steps should be completed from the local directory created

###Data Cleaning Project Goal

Select vectors from the original study that represent mean and standard 
deviation for each combination of subject and activity.  For the selected vectors, calculate a mean value.  Store results in a tidy data set. 

The specific measurements retained from the original study (79 in total) are spelled out in the Code Book section below.  

###Approach Within Project Script

*Step 1: Load dplyr package*

Functions from this package will simplify R script steps below

*Step 2. Read the datasets*

Reads are completed for the individual files from the training directory and the test directory.  A total of 6 files comprise the data needed to reconstruct the study dataset.  Script merges these 6 file into a dataset comparable to the study dataset that existed prior to random division into "training" and "test". Fast read (fread) cannot be used in R for the read as the fread function incorrectly identifies number of columns and subsequently encounters read errors.

+ X datasets represent the 561 vectors derived in the study, 1 column per vector
+ Features.txt contains the measurement names for those 561 derived vectors.  
+ Y datasets represent the activities performed; values will range 1-6 for the 6 activities measured; rows align 1:1 with X datasets.  Critical that these rows not move in subsequent steps and remain aligned with matching rows in X as they do in the study data
+ Subject datasets represent the 1-30 subjects; rows align 1:1 with X and Y 
+ Activity_labels.txt contains the descriptions for each of the 1-6 activities

*Step 3. Variable name cleanup*

Variable names as provided by original study indicate whether the vector was measured by the accelerometer ("Acc") or gyroscope ("Gyro"); whether the derived vector represents body ("fBody") or gravity ("fGravity"); whether the calculations were completed over time domain ("tBody") or frequency domain ("fBody").  As 
part of the effort to create tidy data, these variable names will be expanded 
within the script to provide more user friendly info.  Some additional measure 
name cleanup was also necessary, specifically

+ some values do not align with study info, for example fBodyBody should be 
fBody according to study documentation
+ duplicate measurement names have been created by the current naming 
conventions.  These need to be resolved for subsequent steps of R script to work 
accurately.  This is done by appending a unique identifier (index of the 
vector within the 561 vector set) to the end of the variable name
+ use of , and - are invalid characters for R variable names, and are 
replaced with "_"
+ study variables include () presumably to indicate derivation by functions.  These are invalid for R variable names and could be inaccurately viewed as 
functions in subsequent analysis

*Step 4. Merge the datasets*
    
+ bind rows for each of the X, Y, and Subject datasets.  It is critically important that this be done in the exact sequence for all 3 combinations.  If X binds train data to end of test data, then Y and Subject must do the same.  This results in 10299 rows for each dataset
+ name the columns within each dataset; this is done at this stage to avoid 
duplication of R default name "V1" in the subsequent combined datasets
+ for the columns in the X datasets, merge the R script adjusted features 
descriptions to provide meaningful column descriptions for each vector.  The names as provided in the features file are in exact order of values in X dataset, so assignment to X column names is done by position and does not require matching by ID column 
+ bind columns for Subject, Y, and X (in that order) to reconstruct the 
original dataset
+ merge activity descriptions into the dataset using the column "ID". Critically important that this merge not be done until original dataset reconstructed as merge in R can move rows of data frame in undefined order

*Step 5. Select the desired data and generate tidy dataset*

Decision must be made as to whether to use long form or wide form of tidy dataset.  Given the nature of the study vectors decomposition and derivation from initial signals, it would be difficult to state that these measurements are independent.  As such, it is difficult to store them as separate rows/observations which imply independent observations.  

Although it is not clear what subsequent analysis will be completed on the tidy 
data, it is reasonable to assume that some level of correlation assessment 
might be needed.  This will be easiest if these measurements are presented as 
individual columns, so the wide form will be utilized.  If long form is needed, this can be easily accomplished with the melt() function using "Subject" and "Activity" as the ID columns.

To complete the tidying of the data

+ select columns "Subject" "Activity", and any that contain "mean" or "std"
+ exclude those columns with "angle" in the name as in viewing the original 
features names it is clear that mean actually referred to arguments of the angle function and did not represent a mean measurement
+ group by subject and activity in preparation for calculating summary 
statistic for each group
+ calculate mean for each variable vector by subject and activity

*Step 6. Write the tidy dataset*

Write the result as a txt file; ensure no row names in output

###Data Setup

As stated in the CodeBook.md, it is assumed that the original study data has been previously downloaded as peer reviewers completed the same assignment.  If this has not been done, please follow these steps
  
  * download https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip
  
  * extract all files to a local directory

###Validation Setup

Step 1: Copy the run_analysis.R script in this GitHub directory to the local directory containing the extracted study data.  This can be accomplished with git, or by clicking on link in this Github directory, accessing the Raw form of the file, copying script contents, and saving to approriately named R script file.

Step 2: Copy the compareTidyDatasets.R script down to directory containing the study data in manner similar to step #1

###Validation Steps

Step 1: From R console, setwd() to the local directory containing the study files.

Step 2: Run the run_analysis.R script from R console.  This may take several seconds to complete due to the reading of the large study files.

Step 3: Validate that a new dataset named tidydata.txt has been stored in working directory.

Step 4: Open the compareTidyDatasets.R script, and validate the fileURL reflects the tidy dataset indicated in the Coursera submission

Step 5: Run the compareTidyDatasets.R script from R console.  Script downloads the Coursera submitted tidy dataset and compares to the dataset generated in Step #2.  Result of TRUE will display to console.  If result displays FALSE, review previous steps to ensure all were followed.
